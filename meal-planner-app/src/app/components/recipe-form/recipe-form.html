<div class="recipe-form-container">
  <header class="header">
    <button class="back-button" (click)="cancel()" aria-label="Back">
      ‚Üê
    </button>
    <h1>{{ isEditMode ? 'Edit Recipe' : 'New Recipe' }}</h1>
    <button class="save-button" (click)="saveRecipe()">Save</button>
  </header>

  <div class="form-content">
    <!-- Validation Errors -->
    @if (validationErrors.length > 0) {
      <div class="validation-errors">
        @for (error of validationErrors; track error) {
          <p class="error-message">{{ error }}</p>
        }
      </div>
    }

    <!-- Recipe Name -->
    <div class="form-section">
      <label for="recipeName">Recipe Name *</label>
      <input
        type="text"
        id="recipeName"
        [(ngModel)]="recipeName"
        placeholder="e.g., Chicken Pasta"
        class="form-input"
      />
    </div>

    <!-- Servings -->
    <div class="form-section">
      <label for="servings">Servings (optional)</label>
      <input
        type="number"
        id="servings"
        [(ngModel)]="servings"
        placeholder="4"
        min="1"
        class="form-input"
      />
    </div>

    <!-- Ingredients -->
    <div class="form-section">
      <label>Ingredients *</label>

      <!-- Ingredient List -->
      @if (ingredients.length > 0) {
        <ul class="item-list">
          @for (ingredient of ingredients; track $index) {
            <li class="list-item">
              <span class="item-text">‚Ä¢ {{ formatIngredient(ingredient) }}</span>
              <button
                class="delete-button"
                (click)="removeIngredient($index)"
                aria-label="Delete ingredient"
              >
                üóëÔ∏è
              </button>
            </li>
          }
        </ul>
      }

      <!-- Inline Ingredient Form -->
      @if (showIngredientForm) {
        <div class="inline-form">
          <input
            type="text"
            [(ngModel)]="newIngredient.quantity"
            placeholder="Quantity"
            class="inline-input small"
          />
          <input
            type="text"
            [(ngModel)]="newIngredient.unit"
            placeholder="Unit"
            class="inline-input small"
          />
          <input
            type="text"
            [(ngModel)]="newIngredient.name"
            placeholder="Ingredient"
            class="inline-input"
            (keyup.enter)="addIngredient()"
          />
          <button
            class="add-button"
            (click)="addIngredient()"
            [disabled]="!newIngredient.name.trim()"
          >
            Add
          </button>
        </div>
      }

      <button
        class="toggle-form-button"
        (click)="toggleIngredientForm()"
      >
        {{ showIngredientForm ? '‚àí Close' : '+ Add Ingredient' }}
      </button>
    </div>

    <!-- Instructions -->
    <div class="form-section">
      <label>Instructions *</label>

      <!-- Instruction List -->
      @if (instructions.length > 0) {
        <ol class="numbered-list">
          @for (instruction of instructions; track $index) {
            <li class="list-item">
              <span class="item-text">{{ instruction }}</span>
              <button
                class="delete-button"
                (click)="removeInstruction($index)"
                aria-label="Delete instruction"
              >
                üóëÔ∏è
              </button>
            </li>
          }
        </ol>
      }

      <!-- Inline Instruction Form -->
      @if (showInstructionForm) {
        <div class="inline-form">
          <textarea
            [(ngModel)]="newInstruction"
            placeholder="Enter instruction step..."
            class="inline-textarea"
            rows="2"
            (keyup.enter)="addInstruction()"
          ></textarea>
          <button
            class="add-button"
            (click)="addInstruction()"
            [disabled]="!newInstruction.trim()"
          >
            Add
          </button>
        </div>
      }

      <button
        class="toggle-form-button"
        (click)="toggleInstructionForm()"
      >
        {{ showInstructionForm ? '‚àí Close' : '+ Add Step' }}
      </button>
    </div>

    <!-- Prep Time -->
    <div class="form-section">
      <label for="prepTime">Prep Time (minutes, optional)</label>
      <input
        type="number"
        id="prepTime"
        [(ngModel)]="prepTime"
        placeholder="10"
        min="0"
        class="form-input"
      />
    </div>

    <!-- Cook Time -->
    <div class="form-section">
      <label for="cookTime">Cook Time (minutes, optional)</label>
      <input
        type="number"
        id="cookTime"
        [(ngModel)]="cookTime"
        placeholder="20"
        min="0"
        class="form-input"
      />
    </div>
  </div>
</div>
